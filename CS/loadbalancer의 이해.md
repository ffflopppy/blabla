# loadbalancer
웹사이트나 애플리케이션에 접속하는 수많은 사용자의 네트워크 트래픽을 여러 서버로 균등하게 분산시켜, 단일 서버에 부하가 집중되는 것을 방지하고 서비스의 안정성과 고가용성을 확보하는 장치 또는 소프트웨어 기술

## 핵심 특징 및 기능
- 부하 분산: 클라이언트의 요청을 최적의 서버들로 배포하여 특정 서버의 과부하를 막음.
- 고가용성(HA): 특정 서버가 다운되어도 다른 서버가 트래픽을 처리하여 서비스 중단 방지.
- 확장성: 트래픽 증가에 따라 서버를 손쉽게 추가하여 유연하게 대응 가능.
- 주요 알고리즘: Round Robin(순차적), Least Connections(연결 수가 가장 적은 서버), Weight(가중치) 등.
- 유형: L4 로드밸런서(IP/Port 기준), L7 로드밸런서(URL/Header 등 콘텐츠 기반). 

## LB 종류
L4 로드밸런서 (네트워크 레벨)

- IP, 포트만 보고 분배
- 요청 내용을 모름
- 주로 하드웨어 장비 (F5, 화웨이 등)

L7 로드밸런서 (애플리케이션 레벨)

- HTTP 내용까지 봄
- nginx, haproxy, AWS ALB 등

### nginx - 웹서버 + 로드밸런서
- 원래는 웹서버 (정적 파일 서빙, SSL 처리)
- LB 기능도 있지만 HAProxy보다 약함
- drain이 되긴 하는데 HAProxy처럼 소켓 명령이 아니라 설정 파일 수정 후 reload 방식
- 
### HAProxy - 로드밸런싱 전문
- 트래픽 분배가 주 목적
- drain, 헬스체크 등 LB 기능이 매우 강력
- 웹 서버 기능 없음 (정적 파일 서빙 못함)


---

## NLB (Network Load Balancer)
= L4 로드밸런서
- IP, 포트만 보고 분배
- 빠름, TCP/UDP 처리

## ALB (Application Load Balancer)
= L7 로드밸런서
- HTTP 내용까지 보고 분배
- URL, 헤더 기반 라우팅 가능

## SLB (Server Load Balancer)
- L4, L7 둘 다 포함한 개념

## GSLB (Global Server Load Balancer)
= 지역간 로드밸런싱
- L4/L7과 다른 차원이에요

서울 서버 ←─ GSLB ─→ 미국 서버  
한국 사용자 → 서울로  
미국 사용자 → 미국으로  

---
L4 LB → TCP까지 떼고 봄  
L7 LB → HTTP까지 떼고 봄  
**떼고 본 다음에 다시 붙여서 서버로 보내는 것**

> ### 데이터를 전송할때 생기는 일
>  앱 데이터  
> +HTTP 헤더  (L7)  
> +TCP 헤더   (L4)  
> +IP 헤더    (L3)  
> +이더넷 헤더 (L2)
> → 전송

받는 쪽에서는 계층별로 하나씩 헤더를 떼낸다.

> ### L4 LB가 하는 일  
> 이더넷 헤더 떼고  
> IP 헤더 떼고  
> TCP 헤더까지 떼고 → 여기까지만 봄  
> → IP:포트 확인 후 서버로 전달

> ### L7 LB가 하는 일
> 이더넷 헤더 떼고
> IP 헤더 떼고 
> TCP 헤더 떼고
> HTTP 헤더까지 떼고 → 여기까지 봄
> → URL, 헤더 내용 확인 후 서버로 전달
 

